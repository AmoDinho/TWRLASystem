@model IEnumerable<TRWLASystemMaster.Models.NoAttend>


@{
    ViewBag.Title = "NoAttend";
    Layout = "~/Views/Shared/VolunteerLoggedInPage.cshtml";
}

<div class="jumbotron" style="margin-bottom:150px;">
    <h2>No Attendendance Report</h2>
    <div class="quoteform"></div>
    <div class="quote1form"></div>
    <div class="quote2form"></div>

</div>
<h2 style="z-index:100; position:relative; background-color:transparent;">Filter No Attendance</h2>
<h3>By Student Name:</h3>
@using (Html.BeginForm())
{
    <div class="form-inline" style="margin-bottom:10px;">
        <p data-toggle="tooltip" title="Search by name" class="form-group">
            @Html.TextBox("namesearchString", "", new { placeholder = "Name of Student", @class = "form-control", style = "width:100%;" })
        </p>

        <p class="form-group">
            <button data-toggle="tooltip" title="Search" type="submit" value="Search" class="btn"><i class="fa fa-search" aria-hidden="true" style="color:black;"></i></button>
        </p>
    </div>
}
<h3>By Residence name:</h3>
@using (Html.BeginForm())
{
    <div class="form-inline" style="margin-bottom:10px;">
        <p data-toggle="tooltip" title="Search by name" class="form-group">
            @Html.TextBox("resname", "", new { placeholder = "Name of Residence", @class = "form-control", style = "width:100%;" })
        </p>

        <p class="form-group">
            <button data-toggle="tooltip" title="Search" type="submit" value="Search" class="btn"><i class="fa fa-search" aria-hidden="true" style="color:black;"></i></button>
        </p>
    </div>
}

<p>Total number of students who have RSVPd to events: <strong>@ViewBag.Attend</strong></p>
<p>Total number of students who have RSVPd to but not attended the events: <strong>@ViewBag.Count</strong></p>

@using (Html.BeginForm("ExportToExcel5", "TRWLASchedules", FormMethod.Post))
{
    <div class="row" style="height:500px; overflow-y:auto;">
        <table class="table">
            <tr>
                <th>
                    Name
                </th>
                <th>
                    Surname
                </th>
                <th>
                    Student Number
                </th>
                <th>
                    Date of Birth
                </th>
                <th>
                    Degree
                </th>
                <th>
                    Residence
                </th>
                <th>
                    Name of Event
                </th>
                <th>
                    Date of Missed Event
                </th>
            </tr>

            @foreach (var item in Model)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.Name)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Surname)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.StudNo)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DoB, new { type = "date" })
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Degree)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Res)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.FuncName)
                        @Html.DisplayFor(modelItem => item.LecName)
                        @Html.DisplayFor(modelItem => item.ComName)
                        @Html.DisplayFor(modelItem => item.GenName)
                    </td>

                    <td>
                        @Html.DisplayFor(modelItem => item.FunctionDate)
                        @Html.DisplayFor(modelItem => item.LectureDate)
                        @Html.DisplayFor(modelItem => item.ComEngDate)
                        @Html.DisplayFor(modelItem => item.GenDate)
                    </td>

                </tr>
            }
        </table>
        </div>
       

        <div class="form-inline" style="float:right; margin-bottom:20px;">
            <div class="form-actions no-color form-group" data-toggle="tooltip" title="Export to Excel">
                <button type="submit" value="Export to Excel" class="btn"><i class="fa fa-file-excel-o" aria-hidden="true"></i></button>
            </div>

            <div class="form-group">
                <div style="margin-right:5px; float:right; " data-toggle="tooltip" title="Return to Report Main Menu" >
                    <button type="button" class="btn" onclick="location.href='@Url.Action("MainReportPage", "TRWLASchedules")'"><i class="fa fa-arrow-left" aria-hidden="true"></i></button>
                </div>
            </div>
        </div>
        }
