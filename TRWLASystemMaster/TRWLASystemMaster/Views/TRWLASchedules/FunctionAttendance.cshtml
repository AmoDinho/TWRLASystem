@model IEnumerable<TRWLASystemMaster.Models.AttendanceViewModel>

@{
    ViewBag.Title = "FunctionAttendance";
    Layout = "~/Views/Shared/VolunteerLoggedInPage.cshtml";
}


    <div class="jumbotron" style="margin-bottom:150px;">
        <h2>Function Attendance Report</h2>
        <div class="quoteform"></div>
        <div class="quote1form"></div>
        <div class="quote2form"></div>
    </div>

<h2 style="z-index:100; position:relative; background-color:transparent;">Filter Function Events</h2>
<h3>By Event Name:</h3>
@using (Html.BeginForm())
{
    <div class="form-inline" style="margin-bottom:10px;">
        <p data-toggle="tooltip" title="Search by name" class="form-group">
            @Html.TextBox("namesearchString", "", new { placeholder = "Name of Event", @class = "form-control", style = "width:100%;" })
        </p>

        <p class="form-group">
            <button data-toggle="tooltip" title="Search" type="submit" value="Search" class="btn"><i class="fa fa-search" aria-hidden="true" style="color:black;"></i></button>
        </p>
    </div>
}
<h3>By Residence name:</h3>
@using (Html.BeginForm())
{
    <div class="form-inline" style="margin-bottom:10px;">
        <p data-toggle="tooltip" title="Search by name" class="form-group">
            @Html.TextBox("resname", "", new { placeholder = "Name of Residence", @class = "form-control", style = "width:100%;" })
        </p>

        <p class="form-group">
            <button data-toggle="tooltip" title="Search" type="submit" value="Search" class="btn"><i class="fa fa-search" aria-hidden="true" style="color:black;"></i></button>
        </p>
    </div>
}


<hp>Total number of students who have attended functions: <strong>@ViewBag.Count</strong></hp>

@using (Html.BeginForm("ExportToExcel1", "TRWLASchedules", FormMethod.Post))
{
    <div class="row" style="height:500px; overflow-y:auto;">
        <table class="table">
            <tr>
                <th>
                    Name of Event
                </th>
                <th>
                    Date of Event
                </th>
                <th>
                    Start of the Event
                </th>
                <th>
                    End of the Event
                </th>
                <th>
                    Venue
                </th>
                <th>
                    Content
                </th>
                <th>
                    Student Number
                </th>
                <th>
                    Student Name
                </th>
                <th>
                    Student Surname
                </th>
            </tr>

            @foreach (var item in Model.OrderBy(p => p.EventName))
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.EventName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.EventDate)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.StartTime)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.EndTime)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Residence)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.specific)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.StudentNp)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Student_Name)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.LastName)
                    </td>
                </tr>
            }
        </table>
        </div>

        <div class="form-inline" style="float:right; margin-bottom:20px;">
            <div class="form-actions no-color form-group" data-toggle="tooltip" title="Export to Excel">
                <button type="submit" value="Export to Excel" class="btn"><i class="fa fa-file-excel-o" aria-hidden="true"></i></button>
            </div>

            <div class="form-group">
                <div style="margin-right:5px; float:right;">
                    <button data-toggle="tooltip" title="Return to Report Main Menu" type="button" class="btn" onclick="location.href='@Url.Action("MainReportPage", "TRWLASchedules")'"><i class="fa fa-arrow-left" aria-hidden="true"></i></button>
                </div>
            </div>
        </div>
}

